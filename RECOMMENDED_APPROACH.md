# SysML v2 Modeler リポジトリ移行に関する推奨アプローチ

## 現状分析

現在、アプリケーションは次の重要な依存関係を持っています：

1. `package.json`のスクリプトは`server/index.ts`を直接参照
2. `server/index.ts`は`server/routes.ts`と`server/vite.ts`をインポート
3. `server/vite.ts`は`client/index.html`を参照
4. `src/`ディレクトリ内のファイルにはまだ旧パス構造への参照が残っている

## 推奨アプローチ：段階的移行の継続

以下の理由から、計画通りの段階的移行を続けることを推奨します：

1. **安定性の確保**: 一度に全ての旧ディレクトリを削除すると、アプリケーションが機能しなくなる可能性が高い
2. **テスト容易性**: 各フェーズ後に継続的にアプリケーションをテストできる
3. **リスク管理**: 問題が発生した場合、影響を受ける部分を特定しやすい

## 最終移行プラン（2025年5月末まで）

### フェーズ1：移行準備の完了（現在進行中）
- ✓ 設定ファイルの移行
- ✓ 資産ファイルの移行
- → パス修正スクリプト（fix-imports.js）の強化

### フェーズ2：サーバーコードの移行（4月末）
- `src/server/`ディレクトリを作成
- 現在の`server/`からのファイルをコピー
- パスを修正
- 両方の実装が並行して機能するようにする

### フェーズ3：クライアントコードの移行（5月初旬）
- `src/client/`を完全に機能させる
- `index.html`の参照を修正
- `vite.config.ts`の更新でパスを新構造に変更

### フェーズ4：package.jsonの更新（5月中旬）
- スクリプトを更新して`src/server/index.ts`を使用

### フェーズ5：旧ディレクトリの削除（5月末）
- 動作テスト後、旧ディレクトリを削除

## チームへの提案

この移行計画を守り、各フェーズを慎重に進めることで、サービス中断のリスクを最小限に抑えながら、コードベースを整理することができます。

## 暫定的なディレクトリ構造保持の承認

チームが`server/`、`client/`、`shared/`の各ディレクトリを削除したい場合は、以下の対応策が必要です：

1. `package.json`のスクリプトを更新して`src/server/index.ts`を参照
2. 重要なファイルを`src/`ディレクトリ構造に移行
3. すべてのファイルへの参照を更新

ただし、このアプローチは追加のリスクを伴うため、テストが十分でない場合は推奨しません。